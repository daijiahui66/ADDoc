@tailwind base;
@tailwind components;
@tailwind utilities;

/* --- 文章排版样式 (优化版) --- */
.prose h1, .prose h2 { border-bottom: none !important; padding-bottom: 0.3em; } /* Remove bottom border */
.prose h2 { font-size: 1.5rem; font-weight: 700; color: #1e293b; margin-top: 2.5rem; margin-bottom: 1.25rem; }
.prose h3 { font-size: 1.25rem; font-weight: 600; color: #334155; margin-top: 2rem; margin-bottom: 1rem; scroll-margin-top: 80px; }
.prose p { margin-bottom: 1.25rem; line-height: 1.7; color: #475569; white-space: pre-wrap; } /* Preserve whitespace and line breaks */

/* --- 列表样式修复 --- */
.prose ul { list-style-type: disc; padding-left: 1.625rem; margin-bottom: 1.25rem; color: #475569; }
.prose ol { list-style-type: decimal; padding-left: 1.625rem; margin-bottom: 1.25rem; color: #475569; }
.prose li { margin-bottom: 0.375rem; }
.prose ul ul, .prose ol ul { list-style-type: circle; margin-bottom: 0.5rem; }
.prose ol ol, .prose ul ol { list-style-type: lower-roman; margin-bottom: 0.5rem; }

/* --- 标题样式补全 --- */
.prose h1 { font-size: 2.25rem; font-weight: 800; color: #0f172a; margin-top: 2.5rem; margin-bottom: 1.5rem; line-height: 1.1; letter-spacing: -0.025em; }
.prose h4 { font-size: 1.125rem; font-weight: 600; color: #334155; margin-top: 1.5rem; margin-bottom: 0.75rem; }
.prose h5 { font-size: 1rem; font-weight: 600; color: #334155; margin-top: 1.25rem; margin-bottom: 0.5rem; }
.prose h6 { font-size: 0.875rem; font-weight: 600; color: #475569; margin-top: 1rem; margin-bottom: 0.5rem; text-transform: uppercase; letter-spacing: 0.05em; }

/* --- 引用块样式 --- */
.prose blockquote { 
    border-left: 4px solid #cbd5e1; 
    background-color: #f8fafc; 
    padding: 1rem 1.25rem; 
    margin-bottom: 1.25rem; 
    color: #475569; 
    font-style: italic; 
    border-radius: 0 0.25rem 0.25rem 0;
}
.prose blockquote p:last-child { margin-bottom: 0; }

/* --- 扩展语法样式 (Mark, Sub, Sup) --- */
.prose mark { background-color: #fef08a; color: #854d0e; padding: 0.125rem 0.25rem; border-radius: 0.125rem; }
.prose sub { vertical-align: sub; font-size: 75%; }
.prose sup { vertical-align: super; font-size: 75%; }

/* --- 链接样式美化 (Modern Anchor Links) --- */
.prose a { 
  color: #3b82f6; /* 主题蓝 */
  text-decoration: none; 
  border-bottom: 1px solid rgba(59, 130, 246, 0.3); /* 呼吸感的下划线 */
  font-weight: 500;
  transition: all 0.2s ease; 
  padding: 0 2px; /* 稍微给点内边距，为了 hover 时的背景好看 */
}

.prose a:hover { 
  color: #1d4ed8; /* 深蓝 */
  background-color: rgba(59, 130, 246, 0.1); /* 荧光笔效果 */
  border-bottom-color: transparent; 
  border-radius: 4px; /* 圆角 */
}

/* 仅对有文本内容的链接添加小箭头 (排除图片链接) */
.prose a:not(:has(img))::after { 
    content: "↗"; 
    font-family: sans-serif; 
    font-size: 0.7em; 
    margin-left: 2px; 
    vertical-align: text-top; 
    opacity: 0.6; 
}

/* --- 任务列表样式 (美化版) --- */
.prose .task-list-item { list-style-type: none; padding-left: 0; display: flex; align-items: flex-start; }

/* 隐藏默认复选框 */
.prose .task-list-item input[type="checkbox"] { 
    appearance: none; 
    width: 1.1em; 
    height: 1.1em; 
    border-radius: 50%; 
    border: 1px solid #d1d5db; 
    background-color: #f3f4f6; 
    margin-right: 0.75rem; 
    margin-top: 0.25rem; 
    flex-shrink: 0;
    cursor: pointer;
    position: relative;
    vertical-align: text-bottom;
    transition: all 0.2s ease;
}

/* 选中状态 */
.prose .task-list-item input[type="checkbox"]:checked { 
    background-color: #10b981; 
    border-color: #10b981; 
}

/* 选中时的对号 */
.prose .task-list-item input[type="checkbox"]:checked::after {
    content: '';
    position: absolute;
    left: 35%;
    top: 20%;
    width: 30%;
    height: 50%;
    border: solid white;
    border-width: 0 2px 2px 0;
    transform: rotate(45deg);
}

/* Hover 效果 */
.prose .task-list-item input[type="checkbox"]:hover {
    border-color: #9ca3af;
}
.prose .task-list-item input[type="checkbox"]:checked:hover {
    background-color: #059669;
    border-color: #059669;
}

/* 正文行内代码 (灰色背景，粉色文字) */
.prose :not(pre) > code { 
    background-color: #f1f5f9; 
    color: #ec4899; 
    padding: 0.2rem 0.4rem; 
    border-radius: 0.375rem; 
    font-size: 0.875rem; 
    font-family: monospace; 
    border: 1px solid #e2e8f0;
}

/* Mac Style Code Blocks (GitHub Dark Theme) */
pre.hljs {
    background-color: #0d1117 !important; /* Matches GitHub Dark background */
    color: #c9d1d9;
    padding: 1.25rem;
    padding-top: 3rem; /* Space for Mac dots */
    border-radius: 0.75rem;
    overflow-x: auto;
    margin-top: 1.5rem;
    margin-bottom: 1.5rem;
    position: relative;
    border: 1px solid #1e2229;
    box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.2), 0 4px 6px -2px rgba(0, 0, 0, 0.1);
    font-family: 'Fira Code', 'Menlo', 'Monaco', 'Courier New', monospace;
    line-height: 1.6;
}

pre.hljs::before {
    content: '';
    position: absolute;
    top: 1rem;
    left: 1rem;
    height: 0.75rem;
    width: 0.75rem;
    background-color: #ff5f56; /* Red */
    border-radius: 50%;
    box-shadow: 1.5rem 0 0 #ffbd2e, 3rem 0 0 #27c93f; /* Yellow, Green */
    z-index: 10;
}

/* Ensure inner code doesn't override background */
pre.hljs code {
    background-color: transparent !important;
    padding: 0;
    color: inherit;
    font-size: 0.9rem;
}

/* 侧边栏激活项样式 */
.active-sidebar-item { 
    color: #2563eb; 
    background-color: #eff6ff; 
    font-weight: 500;
}
.active-sidebar-item::before {
    content: '';
    position: absolute;
    left: 0;
    top: 0;
    bottom: 0;
    width: 3px;
    background-color: #2563eb;
    border-top-right-radius: 2px;
    border-bottom-right-radius: 2px;
}

/* --- High Contrast Overrides for Code Blocks --- */
/* 强制覆盖 highlight.js 的默认颜色，解决"看不清"的问题 */

/* 1. 字符串 (Strings) - 对应 "UTF-8" - 改为明亮的青蓝色 */
.prose pre.hljs .hljs-string,
.prose pre.hljs .hljs-selector-attr,
.prose pre.hljs .hljs-template-variable,
.prose pre.hljs .hljs-addition {
    color: #a5d6ff !important;
}

/* 2. 属性名 (Attributes) - 对应 charset - 改为柔和的淡紫色 */
.prose pre.hljs .hljs-attr,
.prose pre.hljs .hljs-attribute,
.prose pre.hljs .hljs-variable {
    color: #d2a8ff !important;
}

/* 3. 关键字/标签 (Keywords/Tags) - 对应 meta, html, function - 改为明亮的珊瑚红 */
.prose pre.hljs .hljs-keyword,
.prose pre.hljs .hljs-selector-tag,
.prose pre.hljs .hljs-tag,
.prose pre.hljs .hljs-name,
.prose pre.hljs .hljs-deletion {
    color: #ff7b72 !important;
}

/* 4. 注释 (Comments) - 保持灰色但要清晰 */
.prose pre.hljs .hljs-comment,
.prose pre.hljs .hljs-quote {
    color: #8b949e !important;
    font-style: italic;
}

/* 5. 普通文本/标点 - 灰白色 */
.prose pre.hljs {
    color: #c9d1d9 !important; /* 基础文字颜色 */
}

/* --- 表格样式 (Table Styles) --- */
.prose table {
  width: 100%;
  border-collapse: separate; /* 必须改为 separate 才能显示 border-radius */
  border-spacing: 0;         /* 消除单元格间隙 */
  margin-bottom: 1.25rem;
  border-radius: 0.75rem;    /* 外层圆角 12px */
  border: 1px solid #e2e8f0; /* 外边框 */
  overflow: hidden;          /* 确保内容不溢出圆角 */
}

.prose th,
.prose td {
  border-bottom: 1px solid #e2e8f0;
  border-right: 1px solid #e2e8f0;
  padding: 0.75rem 1rem;
  text-align: left;
}

/* 移除最后一行的下边框，避免双重边框 */
.prose tr:last-child td {
  border-bottom: none;
}

/* 移除最后一列的右边框 */
.prose th:last-child,
.prose td:last-child {
  border-right: none;
}

.prose th {
  background-color: #f8fafc;
  font-weight: 600;
  color: #1e293b;
}

.prose tr:nth-child(even) {
  background-color: #fcfcfc;
}

/* 确保角落圆角不被背景色覆盖 (保险起见) */
.prose tr:first-child th:first-child { border-top-left-radius: 0.75rem; }
.prose tr:first-child th:last-child { border-top-right-radius: 0.75rem; }
.prose tr:last-child td:first-child { border-bottom-left-radius: 0.75rem; }
.prose tr:last-child td:last-child { border-bottom-right-radius: 0.75rem; }
